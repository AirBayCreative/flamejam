{% extends "base.html" %}
{% from "_formhelpers.html" import render_field %}

{% block title %}{{ entry.jam.short_name}} Â» {{ entry.name }}{% endblock %}

{% block content %}
<h1>{{ entry.jam.long_name }} &raquo; {{ entry.name }}</h1>

<div class="box">
    <h4>Details</h4>
    <div class="box-content">
        <table class="details">
            <tr><th>Author</th>
                <td><a href="{{ url_for('show_participant', username=entry.participant.username) }}">{{ entry.participant.username }}</a></td></tr>
            
            <tr><th>Jam</th>
                <td><a href="{{ entry.jam.url() }}">{{ entry.jam.getFullName() }}</a></td></tr>
                
            <tr><th>Submitted</th>
                <td>{{ entry.posted | humantime }}</td></tr>
        </table>
    </div>
</div>

<div class="box">
    <h4>Details</h4>
    <div class="box-content">
        <p>{{ entry.description }}</p>
    </div>
</div>

<h2>Ratings</h2>

{% for rating in entry.ratings %}
    <ul>
        <li>Rating id: {{ rating.id }}</li>
        <li>Posted: {{ rating.posted }}</li>
        <li>By: {{ rating.participant.username }}</li>
        <li>Graphics score: {{ rating.score_graphics }}</li>
        <li>Audio score: {{ rating.score_audio }}</li>
        <li>Innovation score: {{ rating.score_innovation }}</li>
        <li>Humor score: {{ rating.score_humor }}</li>
        <li>Fun score: {{ rating.score_fun }}</li>
        <li>Overall score: {{ rating.score_overall }}</li>
        <li>Additional notes: {{ rating.text }}</li>
    </ul>
{% endfor %}

{% if session.logged_in %}
    <h3>Rate this post</h3>
    {% if error %}<p class=error><strong>Error:</strong> {{ error }}{% endif %}
    <form action="{{ url_for('show_entry', jam_name=entry.jam.short_name, entry_name=entry.name, action='new_rating' ) }}" method=post>
        {{ form_rating.hidden_tag() }}
        {{ render_field(form_rating.score_graphics) }}
        {{ render_field(form_rating.score_audio) }}
        {{ render_field(form_rating.score_innovation) }}
        {{ render_field(form_rating.score_humor) }}
        {{ render_field(form_rating.score_fun) }}
        {{ render_field(form_rating.score_overall) }}
        {{ render_field(form_rating.note) }}
        <input type=submit value=Go>
    </form>
{% endif %}

<h3>Comments</h3>
    {% for comment in entry.comments %}
    <ul>
        <li>Comment id: {{ comment.id }}</li>
        <li>Posted: {{ comment.posted }}</li>
        <li>By: {{ comment.participant.username }}</li>
        <li>Text: {{ comment.text }}</li>
    </ul>
    {% endfor %}
        
    {% if session.logged_in %}
        <form action="{{ url_for('show_entry', jam_name=entry.jam.short_name, entry_name=entry.name, action='new_comment') }}" method=post>
            {{ form_comment.hidden_tag() }}
            {{ render_field(form_comment.text) }}
            <input type=submit value=Go>
        </form>
    {% endif %}
{% endblock %}
