{% extends "jam/base.html" %}

{% block title %}{{ team.name }}{% endblock %}

{% block content %}

<h1>
    {{ team.name }}
    <small>for {{ jam.title }}</small>

    {% if current_user and current_user.inTeam(team) %}
    <a href="{{ url_for('team_settings', jam_slug = team.jam.slug) }}" class="btn btn-primary btn-large" style="margin-left: 20px;">Team settings</a>
    {% endif %}
</h1>

{% set games = team.games.all() %}

<div class="row-fluid">
    <div class="span4">
        <h2>Team Details</h2>
        <table class="details">
            <tr><th>Participants</th><td>
                {{ team.members | length }} member{{ "" if team.members | length == 1 else "s" }}
            </td></tr>

            <tr><th>Founded by</th><td>
                {{ team.members[0].getLink() }}
            </td></tr>

            {% if team.wip %}
            <tr><th>Working on</th><td>
                {{ team.wip }}
            </td></tr>
            {% endif %}

            {% if team.livestreams %}
            <tr><th>Livestream</th><td>
                {% for line in team.livestreams.splitlines() %}
                <a href="{{ line }}">LiveStream {{ loop.index }}</a><br />
                {% endfor %}
            </td></tr>
            {% endif %}

            {% if team.irc %}
            <tr><th>IRC Channel</th><td>
                {{ team.irc }}
            </td></tr>
            {% endif %}
        </table>

        <h2>Users in this team</h2>
        <ul class="users">
            {% for member in team.members %}
            <li>{{ member.getLink() }}</li>
            {% endfor %}
        </ul>
    </div>
    <div class="span{{ '5' if games else '8' }}">
        <h2>Devlog</h2>
        <p>
            There are no devlog entries yet.
        </p>
    </div>
    {% if games %}
    <div class="span3">
        <h2>Game{{ "" if games | length == 1 else "s" }}</h2>

        <ul class="games" style="text-align: center;">
        {% for game in games %}
        <li><a href="{{ game.url() }}">
            {% set s = game.screenshots[-1] %}
            {% if s %}
            <img src="{{ s.url }}" title="{{ game.title }}: {{ s.caption }}" />
            {% else %}
            <img src="{{ url_for('static', filename = 'gfx/default-screenshot.png') }}" title="No screenshots submitted yet." />
            {% endif %}

            <span>{{ game.title }}</span>
        </a></li>
        {% endfor %}
        </ul>
    </div>
    {% endif %}
</div>

{% endblock %}
